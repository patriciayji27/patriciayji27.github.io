<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Reading</title>

  <style>
    :root {
      --blue-900: #0f2a44;
      --blue-700: #1f4d7a;
      --blue-500: #3b6ea5;
      --blue-200: #c7d7ea;
      --ink: #0e1620;
      --muted: #5c6b7a;
      --line: rgba(15, 42, 68, 0.18);
      --bg: #ffffff;
    }

    body {
      background: var(--bg);
      color: var(--ink);
      font-family: ui-serif, Georgia, "Times New Roman", serif;
      max-width: 760px;
      margin: 3.5rem auto;
      padding: 0 1.25rem;
      line-height: 1.65;
    }

    nav {
      margin-bottom: 2.5rem;
    }

    nav a {
      color: var(--blue-700);
      text-decoration: underline;
      text-underline-offset: 3px;
      font-weight: 600;
    }

    h1 {
      font-size: 3rem;
      margin: 0 0 2.5rem 0;
      color: var(--blue-900);
    }

    /* === Timeline === */
    .timeline {
      position: relative;
      padding-left: 2.5rem;
    }

    .timeline::before {
      content: "";
      position: absolute;
      left: 0.75rem;
      top: 0;
      bottom: 0;
      width: 2px;
      background: var(--line);
    }

    .item {
      position: relative;
      padding-bottom: 2.25rem;
    }

    .dot {
      position: absolute;
      left: 0.25rem;
      top: 0.35rem; /* aligns with date */
      width: 0.85rem;
      height: 0.85rem;
      border-radius: 50%;
      background: var(--blue-700);
    }

    .date {
      font-size: 0.95rem;
      color: var(--muted);
      margin-bottom: 0.15rem;
    }

    .title {
      font-size: 1.25rem;
      font-weight: 700;
      margin-bottom: 0.15rem;
    }

    .title a {
      color: var(--blue-900);
      text-decoration: underline;
      text-underline-offset: 3px;
    }

    .meta {
      color: var(--muted);
      font-size: 1rem;
      margin-bottom: 0.35rem;
    }

    .tags {
      margin: 0.35rem 0 0.35rem 0;
    }

    .tag {
      display: inline-block;
      font-size: 0.85rem;
      padding: 0.15rem 0.55rem;
      border: 1px solid var(--blue-200);
      border-radius: 999px;
      margin-right: 0.4rem;
      color: var(--blue-700);
    }

    .notes {
      margin-top: 0.35rem;
      color: var(--ink);
    }
  </style>
</head>

<body>
  <nav>
    <a href="/">Home</a>
  </nav>

  <h1>Reading</h1>

  <div class="timeline" id="timeline"></div>

  <script>
    fetch("books.json")
      .then(r => r.json())
      .then(items => {

        // SORT: newest first
        items.sort((a, b) => {
          const ad = a.date
            ? Date.parse(a.date.length === 7 ? a.date + "-01" : a.date)
            : -Infinity;
          const bd = b.date
            ? Date.parse(b.date.length === 7 ? b.date + "-01" : b.date)
            : -Infinity;
          return bd - ad;
        });

        const root = document.getElementById("timeline");

        for (const b of items) {
          const el = document.createElement("div");
          el.className = "item";

          const titleHTML = b.link
            ? `<a href="${b.link}" target="_blank" rel="noreferrer">${b.title}</a>`
            : b.title;

          const tagsHTML = (b.tags || [])
            .map(t => `<span class="tag">${t}</span>`)
            .join("");

          el.innerHTML = `
            <span class="dot"></span>
            <div class="date">${b.date || ""}</div>
            <div class="title">${titleHTML}</div>
            <div class="meta">
              ${(b.author || "")}
              ${b.type ? " · " + b.type : ""}
              ${b.status ? " · " + b.status : ""}
            </div>
            ${tagsHTML ? `<div class="tags">${tagsHTML}</div>` : ""}
            ${b.notes ? `<div class="notes">${b.notes}</div>` : ""}
          `;

          root.appendChild(el);
        }
      });
  </script>
</body>
</html>
